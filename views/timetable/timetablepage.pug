- function getTimetableSummary(timetable) {
-   var summary = `This table shows schedules for a selection of key stops on the route for ${timetable.timetable_label} ${timetable.dayList}.`;
-   if (timetable.orientation = 'vertical') {
-     summary += ' Stops and their schedule times are listed in the columns.';
-   } else if (timetable.orientation = 'horizontal') {
-     summary += ' Schedule times are listed in rows, starting with the stop name in the first cell of the row.';
-   } else if (timetable.orientation = 'hourly') {
-     summary += ' Schedule times are listed in rows, starting with the stop name in the first cell of the row and the minutes after the hour in the second row.';
-   }
-   return summary;
- }

- function formatStopName(stop) {
-   return `${stop.stop_name}${stop.type === 'arrival' ? ' (Arrival)' : stop.type === 'departure' ? ' (Departure)' : ''}`;
- }

- function formatTripName(trip, idx, showDayList) {
-   return `${trip.trip_short_name || `Run #${idx + 1}`}${showDayList ? ` ${trip.dayList}` : ''}`;
- }

.timetable-page(class=`menu-type-${config.menuType}`)
  .row
    .col-md-12
      h1.timetable-page-label= `${timetablePage.timetable_page_label}`
      if config.effectiveDate
        .effective-date= `Effective ${config.effectiveDate}`

  include timetable_menu.pug

  each timetable in timetablePage.timetables
    .timetable(id=`timetable_id_${timetable.timetable_id}` data-day-list=timetable.dayList data-direction-name=timetable.direction_name data-timetable-id=timetable.timetable_id data-direction-id=timetable.direction_id data-route-id=timetable.route_id)
      .row
        .col-md-12
          h2.description= `${timetable.timetable_label} | ${timetable.dayList}`
          .service-notes= timetable.service_notes

      if config.showMap
        .row
          .col-md-12
            .map(id=`map_timetable_id_${timetable.timetable_id}`)

        script.
          (function() {
            var id = 'timetable_id_#{timetable.timetable_id}';
            var geojson = !{JSON.stringify(timetable.geojson)};
            var routeColor = '#{timetable.route.route_color}';
            createMap(id, geojson, routeColor);
          })();

      .row
        .col-md-12
          if timetable.orientation === 'horizontal'
            include timetable_horizontal.pug
          else if timetable.orientation === 'hourly'
            include timetable_hourly.pug
          else
            include timetable_vertical.pug

      .row.timetable-bottom
        .col-md-4.notes
          if timetable.requestStopSymbolUsed
            .note= `${config.requestStopSymbol} = Request stop - call for pickup`
          if timetable.noServiceSymbolUsed
            .note= `${config.noServiceSymbol} = No service at this timepoint`

        .col-md-4
          if timetable.specialDates.includedDates.length
            .included-dates Service provided on:
              span= timetable.specialDates.includedDates.join(', ')
        .col-md-4
          if timetable.specialDates.excludedDates.length
            .excluded-dates Service not provided on:&nbsp;
              span= timetable.specialDates.excludedDates.join(', ')
